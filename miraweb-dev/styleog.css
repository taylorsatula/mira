
/*

Hi Brian!
Did you know that CSS lets you use environmental variables now??!? Thats new to me as of working on this project. Crazy.

*/





/* ========================================
   DESIGN SYSTEM FOUNDATION
   ======================================== */
   
   :root {
           /* Colors */
           --accent-green: #00ff2d;
           --accent-magenta: #ff00ff;
           --accent-yellow: #ffff00;
           
           /* Animation */
           --transition: 0.2s ease;
           
           /* Layout */
           --viewport-height: 100dvh;
           --keyboard-height: env(keyboard-inset-height, 0px);
           --safe-area-top: env(safe-area-inset-top, 0px);
           --safe-area-bottom: env(safe-area-inset-bottom, 0px);
           
           /* Global Sizing */
           --border-radius: 8px;
           --input-padding: 16px;
           --icon-size: 20px;
           
           /* Theme: Dark (default) */
           --bg: #000;
           --text: #fff;
           --surface: rgba(255, 255, 255, 0.05);
           --border: rgba(255, 255, 255, 0.2);
           --icon-filter: invert(1);
           --icon-filter-reverse: invert(0);
   }
   
   [data-theme="light"] {
           --bg: #fff;
           --text: #000;
           --surface: rgba(0, 0, 0, 0.05);
           --border: rgba(0, 0, 0, 0.2);
           --icon-filter: invert(0);
           --icon-filter-reverse: invert(1);
   }
   
   /* Computed variants using color-mix */
   :root {
           --text-secondary: color-mix(in srgb, var(--text) 80%, transparent);
           --text-muted: color-mix(in srgb, var(--text) 60%, transparent);
           --text-faint: color-mix(in srgb, var(--text) 40%, transparent);
           --text-disabled: color-mix(in srgb, var(--text) 20%, transparent);
           
           --surface-hover: color-mix(in srgb, var(--surface) 200%, transparent);
           --surface-active: color-mix(in srgb, var(--surface) 400%, transparent);
           
           --border-strong: color-mix(in srgb, var(--border) 250%, transparent);
           --border-weak: color-mix(in srgb, var(--border) 50%, transparent);
           
           --highlight: color-mix(in srgb, var(--accent-yellow) 30%, transparent);
   }

/* ========================================
   RESET & BASE
   ======================================== */

*                        { margin: 0; padding: 0; box-sizing: border-box; }
body                     { background: var(--bg); color: var(--text); font-family: 'Avenir', 'Monaco', 'Inconsolata', 'Fira Code', monospace; font-weight: 100; height: var(--viewport-height); overflow: hidden; transition: background-color var(--transition), color var(--transition); }

/* ========================================
   UTILITIES
   ======================================== */

.hidden                  { display: none !important; }
.sr-only                 { position: absolute; width: 1px; height: 1px; overflow: hidden; }

/* Text utilities */
.text-secondary          { color: var(--text-secondary); }
.text-muted              { color: var(--text-muted); }
.text-faint              { color: var(--text-faint); }

/* Layout utilities */
.flex                    { display: flex; }
.flex-col                { flex-direction: column; }
.items-center            { align-items: center; }
.justify-center          { justify-content: center; }
.justify-between         { justify-content: space-between; }
.justify-end             { justify-content: flex-end; }

/* ========================================
   ANIMATION SYSTEM
   ======================================== */

@keyframes fade-complex {
           0% { opacity: 1; } 60% { opacity: 0.17; } 80% { opacity: 0.17; }
           88% { opacity: 0.22; } 90% { opacity: 0.16; } 92% { opacity: 0.19; }
           94% { opacity: 0.15; } 96% { opacity: 0.18; } 98% { opacity: 0.12; } 100% { opacity: 0.1; }
   }
   
   @keyframes flicker {
           0% { opacity: 0.1; } 8% { opacity: 0.6; } 12% { opacity: 0.1; } 20% { opacity: 0.1; }
           25% { opacity: 0.7; } 30% { opacity: 0.1; } 40% { opacity: 0.1; } 45% { opacity: 0.8; }
           50% { opacity: 0.1; } 60% { opacity: 0.7; } 65% { opacity: 0.1; } 70% { opacity: 0.8; }
           75% { opacity: 0.1; } 80% { opacity: 0.8; } 85% { opacity: 0.1; } 90% { opacity: 0.8; }
           95% { opacity: 0.7; } 100% { opacity: 1; }
   }
   
   @keyframes shake {
           0%, 90% { transform: rotate(0deg); }
           92% { transform: rotate(-5deg); } 94% { transform: rotate(5deg); }
           96% { transform: rotate(-5deg); } 98% { transform: rotate(5deg); } 100% { transform: rotate(0deg); }
   }
   
   @keyframes pulse-dot {
           0%, 100% { box-shadow: 0 0 2px 1px rgba(0, 255, 0, 0); }
           50% { box-shadow: 0 0 2px 1px rgba(0, 255, 0, 0.6); }
   }
   
   @keyframes bubble-up {
           from { opacity: 0.3; transform: translateY(60px); filter: blur(5px); }
           to { opacity: 1; transform: translateY(0); filter: blur(0px); }
   }
   
   @keyframes woosh-out {
           from { opacity: 1; transform: translateY(0); filter: blur(0); }
           to { opacity: 0; transform: translateY(-80px) scale(0.9); filter: blur(15px); }
   }

/* Animation classes */
.anim-fade-complex       { animation: fade-complex 3s ease forwards; }
.anim-flicker            { animation: flicker var(--transition); }
.anim-shake              { animation: shake 2s infinite; }
.anim-pulse              { animation: pulse-dot 3s ease-in-out infinite; }
.anim-bubble             { animation: bubble-up 0.8s ease-out forwards; }
.anim-woosh              { animation: woosh-out 1.25s ease-out forwards; }

/* Legacy animation class compatibility */
.status-badge:not(.badge-active) { animation: fade-complex 3s ease forwards; }
.queue-indicator         { animation: shake 2s infinite; }

/* JavaScript compatibility - original 'active' class */
/* I kept this here ^^^ because I'm letting sleeping dogs lie. It works fine now and I don't want to adjust it lol */
.status-badge.active,
.badge.active            { opacity: 1 !important; animation: none !important; }
.status-badge:not(.active):not(.badge-active) { animation: fade-complex 3s ease forwards; }

/* ========================================
   COMPONENT SYSTEM
   ======================================== */

/* Button Base */
.btn                     { background: transparent; border: 1px solid var(--border); border-radius: var(--border-radius); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--transition); }
.btn:hover               { background: var(--surface-hover); border-color: var(--text); }
.btn img, .btn svg       {  opacity: 0.8;  transition: opacity var(--transition);  filter: var(--icon-filter);  }
.btn:hover img, .btn:hover svg { opacity: 1; }

/* Button sizes */
.btn-sm                  { width: 32px; height: 32px; }
.btn-md                  { width: 40px; height: 40px; }
.btn-lg                  { width: 36px; height: 36px; border-radius: 50%; }

/* Button variants */
.btn-send                { background: var(--surface-hover); border-color: var(--border); color: var(--text-secondary); }
.btn-send:hover          { background: var(--surface-active); border-color: #0066ff; color: var(--text); }
.btn-send:active         { background: var(--surface-active); border-color: #0066ff; color: var(--text); }
.btn-send:disabled       { opacity: 0.5; cursor: not-allowed; }
.btn-send:disabled:hover { background: var(--surface-hover); border-color: var(--border); color: var(--text-secondary); }

/* Input Base */
.input                   { background: var(--bg); color: var(--text); border: 1px solid var(--border); border-radius: var(--border-radius); outline: none; transition: border-color var(--transition), background-color var(--transition); font-family: inherit; }
.input:focus             { background: var(--bg); border-color: var(--border-strong); box-shadow: 0 0 0 2px var(--border-weak); }
.input::placeholder      { color: var(--text-faint); }

/* Badge System */
.badge                   { padding: 8px; border-radius: 6px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.5s cubic-bezier(0.1, 0.4, 0.2, 1); }
.badge img               { width: var(--input-padding); height: var(--input-padding); filter: var(--icon-filter-reverse); }
.badge-active            { opacity: 1; }
.badge-inactive          { opacity: 0.3; }
.badge-tool              { background: var(--accent-green); }
.badge-workflow          { background: var(--accent-magenta); }
.badge-queue             {  background: red;  color: var(--bg);  border: 2px solid rgb(170, 0, 0); border-radius: var(--icon-size); padding: 6px 12px; font-size: 12px; font-weight: 500; }

/* Badge glow effects */
.badge-tool.active       { box-shadow: 0 0 8px 2px rgba(0, 255, 45, 0.4) !important; }
.badge-workflow.active   { box-shadow: 0 0 8px 2px rgba(255, 0, 255, 0.4) !important; }

/* Popover System */
.popover                 { position: absolute; bottom: calc(100% + var(--icon-size)); left: 50%; transform: translateX(-50%); background: var(--bg); border: 1px solid var(--border); border-radius: 12px; padding: var(--input-padding); min-width: 250px; opacity: 0; pointer-events: none; transition: all var(--transition); backdrop-filter: blur(10px); z-index: 50; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); }
.popover.active          { opacity: 1; pointer-events: auto; }
.popover::after          { content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); border: 8px solid transparent; border-top-color: var(--bg); }
.popover::before         { content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); border: 9px solid transparent; border-top-color: var(--border); z-index: -1; }

/* Scrollbar */
.scrollbar::-webkit-scrollbar             { width: 6px; }
.scrollbar::-webkit-scrollbar-track       { background: transparent; }
.scrollbar::-webkit-scrollbar-thumb       {  background: color-mix(in srgb, var(--text) 20%, transparent); border-radius: 3px; }
.scrollbar::-webkit-scrollbar-thumb:hover {  background: color-mix(in srgb, var(--text) 40%, transparent); }

/* Search Highlight */
.highlight               { background: var(--highlight); padding: 0 2px; border-radius: 2px; }

/* ========================================
   LAYOUT COMPONENTS
   ======================================== */

/* Loading Screen */
#loading-screen          { position: fixed; inset: 0; background: transparent; display: flex; align-items: center; justify-content: center; font-family: monospace; font-size: var(--input-padding); line-height: 1; opacity: 0; pointer-events: none; transition: opacity var(--transition); z-index: -1; }
#loading-screen.active   { opacity: 1; }
.ascii-container         { width: 100%; text-align: center; color: var(--text-secondary); }
.ascii-char              { display: inline-block; opacity: 0; transition: opacity 0.05s ease; }
.ascii-char.visible      { opacity: 1; }

/* Modal System */
.modal-backdrop          { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.2); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; pointer-events: none; transition: opacity var(--transition); }
.modal-backdrop:not(.hidden) { opacity: 1; pointer-events: auto; }
.modal-content           { background: var(--bg); border: 1px solid var(--border); border-radius: 12px; width: min(500px, 90vw); max-height: 80vh; overflow: hidden; transform: scale(0.9); transition: transform var(--transition); }
.modal-backdrop:not(.hidden) .modal-content { transform: scale(1); }
.modal-header            { display: flex; justify-content: space-between; align-items: center; padding: var(--icon-size); border-bottom: 1px solid var(--border-weak); }
.modal-header h2         { font-size: 18px; font-weight: 500; margin: 0; }
.modal-close             { width: 32px; height: 32px; padding: 0; }
.modal-body              { padding: var(--icon-size); overflow-y: auto; max-height: calc(80vh - 73px); }

/* Navigation */
.nav-shifted { /* class for when sidebar is open */ }
.nav-shifted #history-toggle { left: 420px; }
.nav-shifted .menu-icons     { left: 470px; }

/* JavaScript compatibility - original selectors */
#history-drawer.open ~ nav #history-toggle { left: 420px; }
#history-drawer.open ~ nav .menu-icons     { left: 470px; }
#history-toggle          { position: fixed; left: var(--icon-size); top: calc(var(--icon-size) + var(--safe-area-top)); z-index: 101; transition: left 0.3s ease; }
.menu-icons              { position: fixed; left: 70px; top: calc(var(--icon-size) + var(--safe-area-top)); display: flex; gap: 12px; transition: all 0.3s ease; z-index: 101; }
#theme-toggle            { position: relative; overflow: hidden; }
.theme-icon-light, .theme-icon-dark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); transition: opacity var(--transition); width: var(--icon-size); height: var(--icon-size); }

[data-theme="light"] .theme-icon-light { opacity: 1; }
[data-theme="light"] .theme-icon-dark { opacity: 0; }
:root:not([data-theme]) .theme-icon-light,
[data-theme="dark"] .theme-icon-light { opacity: 0; }
:root:not([data-theme]) .theme-icon-dark,
[data-theme="dark"] .theme-icon-dark { opacity: 1; }

/* Sidebar */
#history-drawer          { position: fixed; left: -400px; top: 0; width: 400px; height: var(--viewport-height); background: var(--bg); border-right: 1px solid var(--border); transition: left 0.3s ease; overflow: hidden; z-index: 99; display: flex; flex-direction: column; }
#history-drawer.open     { left: 0; }
.history-header          { padding: var(--icon-size); border-bottom: 1px solid var(--border-weak); flex-shrink: 0; }
.history-search          { width: 100%; background: var(--surface); padding: 12px var(--input-padding); height: 40px; margin-bottom: var(--input-padding); }
.tabs                    { display: flex; gap: 8px; margin-bottom: var(--input-padding); }
.tab-button              { padding: 8px var(--input-padding); background: transparent; border: 1px solid var(--border); border-radius: var(--icon-size); color: var(--text-muted); font-size: 13px; cursor: pointer; transition: all var(--transition); font-family: inherit; }
.tab-button.active       { background: var(--surface-hover); color: var(--text); border-color: var(--border-strong); }
.tab-button:hover        { color: var(--text); border-color: var(--text-faint); }

/* Date Picker */
.date-picker-wrapper     { position: relative; }
.date-picker             { display: flex; align-items: center; gap: 8px; padding: 8px 12px; background: var(--surface); border-radius: var(--border-radius); font-size: 13px; cursor: pointer; transition: all var(--transition); }
.date-picker:hover       { background: var(--surface-hover); }
.date-picker svg         { width: var(--input-padding); height: var(--input-padding); fill: var(--text-muted); }

/* Calendar */
.calendar-popup          { position: absolute; top: 100%; left: 0; right: 0; margin-top: 8px; background: var(--bg); border: 1px solid var(--border); border-radius: 12px; padding: var(--input-padding); opacity: 0; pointer-events: none; transform: translateY(-10px); transition: all var(--transition); z-index: 200; backdrop-filter: blur(10px); }
.calendar-popup.active   { opacity: 1; pointer-events: auto; transform: translateY(0); }
.calendar-header         { display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--input-padding); }
.calendar-month          { font-size: 14px; font-weight: 500; }
.calendar-nav            { display: flex; gap: 8px; }
.calendar-nav button     { background: transparent; border: 1px solid var(--border); color: var(--text); width: 28px; height: 28px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--transition); font-family: inherit; }
.calendar-nav button:hover { background: var(--surface-hover); border-color: var(--text-faint); }
.calendar-grid           { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
.calendar-day-header     { font-size: 11px; color: var(--text-faint); text-align: center; padding: 8px 0; }
.calendar-day            { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 6px; font-size: 13px; cursor: pointer; transition: all var(--transition); position: relative; }
.calendar-day:hover:not(.disabled) { background: var(--surface-hover); }
.calendar-day.active     { background: var(--surface-active); color: var(--text); }
.calendar-day.today      { border: 1px solid var(--border-strong); }
.calendar-day.disabled   { color: var(--text-disabled); cursor: default; }

.calendar-day.has-data::after { content: ''; position: absolute; bottom: 2px; left: 50%; transform: translateX(-50%); width: 3px; height: 3px; background: var(--accent-green); border-radius: 50%; }
.calendar-day.has-data::after { animation: pulse-dot 3s ease-in-out infinite; }

/* History Content */
.history-content         { flex: 1; overflow-y: auto; padding: 0; }
.date-group              { border-bottom: 1px solid var(--border-weak); }
.date-header             { padding: var(--input-padding) var(--icon-size); background: var(--surface); font-size: 12px; color: var(--text-faint); text-transform: uppercase; letter-spacing: 0.5px; position: sticky; top: 0; z-index: 10; backdrop-filter: blur(4px); border-bottom: 1px solid var(--border-weak); }
.conversation-item       { padding: var(--input-padding) var(--icon-size); border-bottom: 1px solid var(--border-weak); cursor: pointer; transition: all var(--transition); }
.conversation-item:hover { background: var(--surface); padding-left: 24px; }
.conversation-time       { font-size: 11px; color: var(--text-faint); margin-bottom: 4px; }
.conversation-user       { font-size: 14px; color: var(--text-secondary); margin-bottom: 6px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.conversation-mira       { font-size: 13px; color: var(--text-muted); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.4; }
.empty-state             { padding: 40px var(--icon-size); text-align: center; color: var(--text-faint); font-size: 14px; }

/* Main Content Area */
main                     { position: fixed; top: 10vh; bottom: 140px; left: 0; right: 0; display: flex; align-items: center; justify-content: center; pointer-events: none; overflow: hidden; }
.response-container      { max-width: 700px; width: 90%; max-height: 100%; opacity: 0; transition: opacity 0.3s ease; pointer-events: auto; }
.response-container.active { opacity: 1; }
.response-box            { color: var(--text); font-size: 18px; line-height: 1.8; word-break: break-word; opacity: 0; }
.response-container.active .response-box:not(.exiting) { animation: bubble-up 0.8s ease-out forwards; }
.response-box.exiting    { animation: woosh-out 1.25s ease-out forwards; }
.response-content        { max-height: calc(var(--viewport-height) - 200px - var(--keyboard-height)); overflow-y: auto; padding-right: var(--icon-size); letter-spacing: 0.3px; }

/* Input Section */
.input-section           { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); width: min(600px, 90vw); z-index: 20; transition: transform 0.3s ease; }
.status-badges           { display: flex; justify-content: flex-end; margin-bottom: 12px; align-items: center; gap: 8px; }
.tool-container, .workflow-container, .queue-container { position: relative; }
.status-badge            { width: 32px; height: 32px; box-sizing: border-box; }
.input-container         { position: relative; z-index: 5; overflow: visible; }
.input-container.firing  { z-index: 10; }
.input-wrapper           { position: relative; display: flex; align-items: center; }
.input-pill              { width: 100%; padding: var(--input-padding) 60px var(--input-padding) 24px; font-size: 15px; position: relative; z-index: 2; }
.input-container.firing .input-pill:focus { background: var(--bg); border-color: var(--border); box-shadow: none; }
.ghost-text              { position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: var(--input-padding) 60px var(--input-padding) 24px; color: var(--text-faint); pointer-events: none; font-size: 15px; line-height: 1; display: flex; align-items: center; font-family: inherit; }
.send-button             { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); z-index: 3; }
.send-button img         { width: var(--icon-size); height: var(--icon-size); }
.message-projectile      { position: absolute; top: 0; left: 0; width: calc(100% - var(--icon-size)); height: 100%; font-size: 15px; color: var(--text); pointer-events: none; z-index: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.4; will-change: transform, opacity; padding: var(--input-padding) 60px var(--input-padding) 24px; display: flex; align-items: center; opacity: 0; text-align: left; }

/* Workflow & Queue Components */
.workflow-step           { padding: 4px; margin: 4px 0; font-size: 13px; color: var(--text-muted); border-left: 3px solid var(--border-weak); transition: all var(--transition); }
.workflow-step.completed { color: var(--text-secondary); border-left-color: var(--accent-green); opacity: 0.8; }
.workflow-step.completed::before { content: 'âœ“ '; color: var(--accent-green); font-weight: bold; }
.workflow-step.active    { color: var(--text); border-left-color: var(--accent-magenta); background: var(--surface); font-weight: 500; }
.workflow-step.pending   { opacity: 0.5; }
.queue-popover           { min-width: 300px; max-width: 400px; }
.queue-header            { font-size: 14px; font-weight: 500; margin-bottom: 12px; color: var(--text-secondary); }
.queue-message           { background: var(--surface); border: 1px solid var(--border-weak); border-radius: var(--border-radius); padding: 12px; margin-bottom: 8px; transition: all var(--transition); }
.queue-message:hover     { background: var(--surface-hover); border-color: var(--border); }
.queue-message-text      { font-size: 13px; color: var(--text-secondary); margin-bottom: 8px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.queue-message-time      { font-size: 11px; color: var(--text-faint); margin-bottom: 8px; }
.queue-message-actions   { display: flex; gap: 8px; }
.queue-send-btn, .queue-remove-btn { padding: 4px 12px; border: 1px solid var(--border); border-radius: 4px; background: transparent; color: var(--text-secondary); font-size: 12px; cursor: pointer; transition: all var(--transition); font-family: inherit; }
.queue-send-btn:hover    { background: var(--accent-green); color: var(--bg); border-color: var(--accent-green); }
.queue-remove-btn:hover  { background: var(--surface-active); border-color: var(--text-faint); }
.queue-count             { min-width: 1ch; text-align: center; }

/* Mobile Fullscreen Popover */
.mobile-fullscreen       { position: fixed !important; inset: 0 !important; width: 100vw !important; height: 100vh !important; transform: none !important; margin: 0 !important; background: var(--bg); border: none; border-radius: 0; padding: calc(60px + var(--safe-area-top)) var(--icon-size) calc(var(--icon-size) + var(--safe-area-bottom)); overflow-y: auto; z-index: 200; }
.mobile-fullscreen::after, .mobile-fullscreen::before { display: none; }
.popover-close           { display: none; position: absolute; top: var(--input-padding); right: var(--input-padding); width: 32px; height: 32px; background: transparent; border: 1px solid var(--border); border-radius: 50%; cursor: pointer; align-items: center; justify-content: center; font-size: var(--icon-size); color: var(--text-secondary); transition: all var(--transition); }
.popover-close:hover     { background: var(--surface-hover); border-color: var(--text-faint); }
.mobile-fullscreen .popover-close { display: flex; }

/* ========================================
   MOBILE RESPONSIVE
   ======================================== */
   
@media (pointer: coarse), (max-width: 768px) {
           .menu-wrapper                { position: fixed; top: 0; left: 0; right: 0; height: calc(60px + var(--safe-area-top)); background: var(--bg); border-bottom: 1px solid var(--border-weak); display: flex; align-items: center; padding: var(--safe-area-top) var(--icon-size) 0 var(--icon-size); z-index: 102;}
           #history-toggle              { position: relative; left: 0; top: 0; margin-right: 12px;}
           .menu-icons                  { position: relative; left: 0; top: 0; margin-left: auto;}
           
           .nav-shifted #history-toggle,
           .nav-shifted .menu-icons     { left: 0; }
           
           #history-drawer              { width: 100%; left: -100%; top: calc(60px + var(--safe-area-top)); height: calc(100vh - 60px - var(--safe-area-top));}
           .history-header              { padding-top: var(--icon-size); }
           .input-section               { bottom: calc(var(--icon-size) + var(--safe-area-bottom)); width: calc(100vw - 40px);}
   }