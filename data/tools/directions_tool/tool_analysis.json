{
  "tool_name": "directions_tool",
  "tool_code": "\"\"\"\nNatural Language Directions tool implementation.\n\nThis tool enhances the standard turn-by-turn directions with human-like natural\nlanguage descriptions that provide road context (e.g., \"turn off the main road onto\nthe side street\") rather than just standard instructions.\n\nRequires Google Maps API key in the config file.\n\"\"\"\n\nimport logging\nimport re\nimport json\nfrom typing import Dict, List, Any, Optional, Union, Tuple\n\nfrom pydantic import BaseModel, Field\nfrom tools.repo import Tool\nfrom errors import ToolError, ErrorCode, error_context\nfrom config.registry import registry\n\n\n# Define configuration class for DirectionsTool\nclass DirectionsToolConfig(BaseModel):\n    \"\"\"Configuration for the directions_tool.\"\"\"\n    enabled: bool = Field(default=True, description=\"Whether this tool is enabled by default\")\n    timeout: int = Field(default=60, description=\"Timeout in seconds for Google Maps API requests\")\n    include_landmarks: bool = Field(default=True, description=\"Whether to include landmarks in enhanced directions\")\n    cache_timeout: int = Field(default=3600, description=\"Cache timeout in seconds (default: 1 hour)\")\n\n\n# Register with registry\nregistry.register(\"directions_tool\", DirectionsToolConfig)\n\n\nclass DirectionsTool(Tool):\n    \"\"\"\n    Tool for generating enhanced natural language directions.\n    \n    This tool transforms standard Google Maps turn-by-turn directions \n    into more natural, context-aware instructions. It detects road \n    classifications (main roads vs. side streets), road transitions, \n    and optionally includes landmarks to create directions that sound \n    more like how a human would give them.\n    \n    Features:\n    1. Road Classification:\n       - Identifies road hierarchy (highways, main roads, side streets)\n       - Detects transitions between different road types\n    \n    2. Natural Language Directions:\n       - Converts standard \"Turn left onto X Street\" to contextual instructions\n       - Includes descriptive elements about the roads\n    \n    3. Optional Landmark Integration:\n       - References nearby landmarks at decision points\n       - Prioritizes highly visible landmarks for easier navigation\n    \"\"\"\n\n    name = \"directions_tool\"\n    description = \"\"\"Provides natural language directions that describe routes in a more human-like way. Use this tool when the user needs directions with contextual information rather than just standard turn-by-turn instructions.\n\nThis tool enhances standard mapping directions to include road context and optional landmarks:\n\n1. get_enhanced_directions: Get natural language directions between two locations.\n   - Requires 'origin' and 'destination' parameters with addresses or coordinates\n   - Optional 'include_landmarks' parameter to reference nearby landmarks (default: true)\n   - Returns enhanced directions with contextual information about roads\n\nExample enhanced directions:\n- Standard: \"Turn right onto Main Street\"\n- Enhanced: \"Turn right off the side street onto the main road (Main Street)\"\n- With landmark: \"Turn right at the Starbucks, onto the main road (Main Street)\"\n\nThis provides a more intuitive navigation experience similar to how humans naturally give directions.\"\"\"\n    usage_examples = [\n        {\n            \"input\": {\n                \"origin\": \"123 Main St, Anytown, USA\",\n                \"destination\": \"456 Oak Ave, Anytown, USA\"\n            },\n            \"output\": {\n                \"origin\": \"123 Main St, Anytown, USA\",\n                \"destination\": \"456 Oak Ave, Anytown, USA\",\n                \"total_distance\": \"2.5 mi\",\n                \"total_duration\": \"8 mins\",\n                \"steps\": [\n                    {\n                        \"instruction\": \"Head south on Main Street (a main road)\",\n                        \"distance\": \"0.2 mi\",\n                        \"duration\": \"1 min\"\n                    },\n                    {\n                        \"instruction\": \"Turn right off the main road onto the side street (Oak Avenue)\",\n                        \"distance\": \"0.3 mi\",\n                        \"duration\": \"2 mins\"\n                    }\n                ]\n            }\n        }\n    ]\n\n    def __init__(self):\n        \"\"\"Initialize the Directions tool.\"\"\"\n        super().__init__()\n        self.logger = logging.getLogger(__name__)\n        self._client = None\n        \n        # Define road classification hierarchy\n        self.road_hierarchy = {\n            \"highway\": [\"highway\", \"motorway\", \"freeway\", \"expressway\", \"interstate\"],\n            \"main_road\": [\"primary\", \"trunk\", \"arterial\", \"major\", \"avenue\", \"boulevard\", \"main\"],\n            \"secondary_road\": [\"secondary\", \"collector\", \"thoroughfare\"],\n            \"side_street\": [\"residential\", \"local\", \"side\", \"minor\", \"lane\", \"way\", \"drive\", \"circle\"]\n        }\n\n    @property\n    def client(self):\n        \"\"\"\n        Get the Google Maps client, initializing it if needed.\n        Lazy loading approach.\n\n        Returns:\n            Google Maps client instance\n\n        Raises:\n            ToolError: If Google Maps API key is not set or client initialization fails\n        \"\"\"\n        if self._client is None:\n            try:\n                from googlemaps import Client\n\n                # Get API key from config\n                from config import config\n                api_key = config.google_maps_api_key\n                if not api_key:\n                    raise ToolError(\n                        \"Google Maps API key not found in configuration.\",\n                        ErrorCode.TOOL_EXECUTION_ERROR,\n                    )\n\n                # Create client with API key\n                self.logger.info(\"Creating Google Maps client with API key\")\n                self._client = Client(key=api_key)\n            except ImportError:\n                raise ToolError(\n                    \"googlemaps library not installed. Run: pip install googlemaps\",\n                    ErrorCode.TOOL_INITIALIZATION_ERROR,\n                )\n            except Exception as e:\n                self.logger.error(f\"Failed to initialize Google Maps client: {e}\")\n                raise ToolError(\n                    f\"Failed to initialize Google Maps client: {e}\",\n                    ErrorCode.TOOL_EXECUTION_ERROR,\n                )\n        return self._client\n\n    def run(\n        self,\n        origin: str,\n        destination: str,\n        include_landmarks: bool = None,\n        travel_mode: str = \"driving\"\n    ) -> Dict[str, Any]:\n        \"\"\"\n        Get enhanced natural language directions between two locations.\n\n        This method serves as the main entry point for the tool. It retrieves\n        standard directions from Google Maps API and enhances them with natural\n        language descriptions that include road context and optional landmarks.\n\n        Args:\n            origin: Starting location (address or coordinates)\n            destination: Ending location (address or coordinates)\n            include_landmarks: Whether to enhance with landmark references (defaults to True)\n            travel_mode: Mode of transportation (driving, walking, bicycling, transit)\n\n        Returns:\n            Dictionary containing enhanced directions with the following structure:\n            {\n                \"origin\": str,\n                \"destination\": str,\n                \"total_distance\": str,\n                \"total_duration\": str,\n                \"steps\": List[Dict] containing enhanced instructions\n            }\n\n        Raises:\n            ToolError: If directions cannot be retrieved or enhanced\n        \"\"\"\n        # Import config\n        from config import config\n        \n        # Use the configured default for landmarks if none provided\n        if include_landmarks is None:\n            include_landmarks = config.directions_tool.include_landmarks\n            \n        self.logger.info(f\"Getting enhanced directions from {origin} to {destination}\")\n        \n        with error_context(\n            component_name=self.name,\n            operation=\"getting enhanced directions\",\n            error_class=ToolError,\n            error_code=ErrorCode.TOOL_EXECUTION_ERROR,\n            logger=self.logger,\n        ):\n            # Validate inputs\n            if not origin or not destination:\n                raise ToolError(\n                    \"Both origin and destination are required parameters\",\n                    ErrorCode.TOOL_INVALID_INPUT,\n                )\n                \n            # Validate travel mode\n            valid_modes = [\"driving\", \"walking\", \"bicycling\", \"transit\"]\n            if travel_mode not in valid_modes:\n                raise ToolError(\n                    f\"Invalid travel mode: {travel_mode}. Must be one of {valid_modes}\",\n                    ErrorCode.TOOL_INVALID_INPUT,\n                )\n            \n            # Get directions from Google Maps API\n            # The actual implementation will be added in subsequent tasks\n            \n            # Temporary placeholder return for now\n            return {\n                \"origin\": origin,\n                \"destination\": destination,\n                \"total_distance\": \"Placeholder\",\n                \"total_duration\": \"Placeholder\",\n                \"steps\": []\n            }",
  "description": "A tool that enhances standard turn-by-turn directions with human-like natural language descriptions that provide road context and optional landmarks for more intuitive navigation.",
  "operations": [
    {
      "name": "get_enhanced_directions",
      "description": "Retrieves standard directions from Google Maps API and enhances them with natural language descriptions that include road context and optional landmarks to create more human-like navigation instructions.",
      "required_parameters": [
        {
          "name": "origin",
          "type": "string",
          "description": "Starting location (address or coordinates)"
        },
        {
          "name": "destination",
          "type": "string",
          "description": "Ending location (address or coordinates)"
        }
      ],
      "optional_parameters": [
        {
          "name": "include_landmarks",
          "type": "boolean",
          "description": "Whether to enhance directions with landmark references",
          "default": "True (from configuration)"
        },
        {
          "name": "travel_mode",
          "type": "string",
          "description": "Mode of transportation (must be one of: driving, walking, bicycling, transit)",
          "default": "driving"
        }
      ]
    }
  ],
  "complexity_category": "standard",
  "recommended_examples": 45
}