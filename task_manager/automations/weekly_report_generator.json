{
  "id": "weekly-report-generator",
  "name": "Weekly Report Generator",
  "description": "Generates and emails weekly business reports every Friday afternoon",
  "type": "sequence",
  "frequency": "weekly",
  "scheduled_time": "16:00:00",
  "day_of_week": 4,
  "timezone": "America/New_York",
  "status": "active",
  "error_policy": "stop",
  "timeout": 7200,
  "max_executions": null,
  "user_id": "system",
  
  "steps": [
    {
      "id": "gather-customer-data",
      "name": "Gather Customer Data",
      "position": 1,
      "description": "Collect customer engagement data from the past week",
      "execution_mode": "direct",
      "tool_name": "customerdatabase_tool",
      "operation": "get_weekly_stats",
      "parameters": {
        "start_date": "-7 days",
        "end_date": "today",
        "metrics": ["new_customers", "appointments", "revenue"]
      },
      "output_key": "customer_data",
      "condition_type": "always",
      "max_retries": 2,
      "retry_delay": 120
    },
    {
      "id": "generate-report",
      "name": "Generate Weekly Report",
      "position": 2,
      "description": "Create a formatted report from the collected data",
      "execution_mode": "orchestrated",
      "task_description": "Generate a comprehensive weekly business report using the customer data. Format it nicely with sections for Key Metrics, Customer Growth, Appointment Analysis, and Revenue Summary. Include appropriate charts and graphs where possible.",
      "available_tools": ["email_tool", "customerdatabase_tool", "http_tool"],
      "parameters": {
        "data": "{customer_data.result}",
        "format": "pdf",
        "include_charts": true
      },
      "output_key": "report",
      "condition_type": "if_success",
      "max_retries": 1,
      "retry_delay": 300
    },
    {
      "id": "email-report",
      "name": "Email Report to Stakeholders",
      "position": 3,
      "description": "Email the generated report to business stakeholders",
      "execution_mode": "direct",
      "tool_name": "email_tool",
      "operation": "send_email",
      "parameters": {
        "to": ["manager@example.com", "ceo@example.com", "operations@example.com"],
        "subject": "Weekly Business Report - {customer_data.result.week_ending}",
        "body": "Please find attached the weekly business report for the period ending {customer_data.result.week_ending}.",
        "attachments": ["{report.result.file_path}"]
      },
      "output_key": "email_result",
      "condition_type": "if_success",
      "max_retries": 3,
      "retry_delay": 180
    },
    {
      "id": "schedule-next-tasks",
      "name": "Schedule Follow-up Tasks",
      "position": 4,
      "description": "Create follow-up tasks based on report insights",
      "execution_mode": "orchestrated",
      "task_description": "Analyze the weekly report data and create appropriate follow-up tasks or reminders. If customer appointments decreased, create a task to review marketing strategy. If revenue is below target, schedule a meeting with the finance team. If new customer signups increased, prepare a message to the marketing team.",
      "available_tools": ["reminder_tool", "customerdatabase_tool"],
      "parameters": {
        "report_data": "{report.result}",
        "threshold_metrics": {
          "appointment_decrease_threshold": -5,
          "revenue_target": 10000,
          "new_customer_growth_threshold": 10
        }
      },
      "output_key": "followup_tasks",
      "condition_type": "if_success",
      "max_retries": 1,
      "retry_delay": 120
    }
  ]
}